This is the controller code ready to use in one neat file.
